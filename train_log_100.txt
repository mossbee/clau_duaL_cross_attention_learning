Setting up training components...
Loading pretrained weights from /kaggle/input/cub-200-2011/ViT-B_16.npz
Model initialized with 100.73M parameters
CUB Dataset: 5994 train samples loaded
CUB Dataset: 5794 test samples loaded
Starting training for 100 epochs
Training samples: 5994
Validation samples: 5794
Physical batch size: 8
Gradient accumulation steps: 2
Effective batch size: 16
Epoch 1: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=3.9254, sa_acc=0.017, glc
Epoch 2: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=3.6110, sa_acc=0.113, glc
Epoch 3: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=3.2224, sa_acc=0.287, glc
Epoch 4: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.8711, sa_acc=0.413, glc
Epoch 5: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.5466, sa_acc=0.481, glc
Evaluating val: 100%|█████████████████████████| 725/725 [03:52<00:00,  3.11it/s]
Epoch 5/100
Train Loss: 2.5405
Val Metric: 60.7525 (Best: 60.7525 @ epoch 5)
New best model saved with metric: 60.7525
Epoch 6: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.3280, sa_acc=0.504, glc
Epoch 7: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.1941, sa_acc=0.516, glc
Epoch 8: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.1346, sa_acc=0.487, glc
Epoch 9: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.1408, sa_acc=0.452, glc
Epoch 10: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.1547, sa_acc=0.417, gl
Evaluating val: 100%|█████████████████████████| 725/725 [03:52<00:00,  3.11it/s]
Epoch 10/100
Train Loss: 2.1577
Val Metric: 39.6099 (Best: 60.7525 @ epoch 5)
Epoch 11: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.2010, sa_acc=0.387, gl
Epoch 12: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.2532, sa_acc=0.349, gl
Epoch 13: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.3144, sa_acc=0.309, gl
Epoch 14: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.3863, sa_acc=0.280, gl
Epoch 15: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.4300, sa_acc=0.263, gl
Evaluating val: 100%|█████████████████████████| 725/725 [03:53<00:00,  3.11it/s]
Epoch 15/100
Train Loss: 2.4372
Val Metric: 24.5426 (Best: 60.7525 @ epoch 5)
Epoch 16: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.4882, sa_acc=0.234, gl
Epoch 17: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.5529, sa_acc=0.211, gl
Epoch 18: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.5750, sa_acc=0.202, gl
Epoch 19: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.6396, sa_acc=0.174, gl
Epoch 20: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.6557, sa_acc=0.163, gl
Evaluating val: 100%|█████████████████████████| 725/725 [03:53<00:00,  3.11it/s]
Epoch 20/100
Train Loss: 2.6554
Val Metric: 16.3445 (Best: 60.7525 @ epoch 5)
Epoch 21: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.6860, sa_acc=0.161, gl
Epoch 22: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7215, sa_acc=0.138, gl
Epoch 23: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7180, sa_acc=0.140, gl
Epoch 24: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7538, sa_acc=0.133, gl
Epoch 25: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7575, sa_acc=0.129, gl
Evaluating val: 100%|█████████████████████████| 725/725 [03:53<00:00,  3.10it/s]
Epoch 25/100
Train Loss: 2.7612
Val Metric: 10.4418 (Best: 60.7525 @ epoch 5)
Epoch 26: 100%|█| 749/749 [16:27<00:00,  1.32s/it, loss=2.7594, sa_acc=0.125, gl
Epoch 27: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7867, sa_acc=0.114, gl
Epoch 28: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7775, sa_acc=0.120, gl
Epoch 29: 100%|█| 749/749 [16:28<00:00,  1.32s/it, loss=2.7742, sa_acc=0.117, gl
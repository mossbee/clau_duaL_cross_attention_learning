Setting up training components...
Loading pretrained weights from /kaggle/input/cub-200-2011/ViT-B_16.npz
✓ Mixed precision training enabled (FP16)
Model initialized with 93.65M parameters
CUB Dataset: 5994 train samples loaded
CUB Dataset: 5794 test samples loaded
Starting training for 100 epochs
Training samples: 5994
Validation samples: 5794
Physical batch size: 4
Gradient accumulation steps: 4
Effective batch size: 16
Epoch 1: 100%|##########| 1498/1498 [33:01<00:00,  1.32s/it, L=8.087, SA=0.00, GL=0.00, PW=0.01, w1=0.0, w2=0.0, w3=0.0]

================================================================================
EPOCH 1 SUMMARY
================================================================================
Learning Rate: 0.000003

Loss Breakdown:
  Total Loss:    8.0871
  SA Loss:       5.3902
  GLCA Loss:     5.4259
  PWCA Loss:     5.3606

Accuracy:
  SA Acc:        0.0047
  GLCA Acc:      0.0028
  PWCA Acc:      0.0050

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0002
  w2 (GLCA):     0.0002
  w3 (PWCA):     0.0002

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9998
  Weight GLCA:   0.9998
  Weight PWCA:   0.9998

⚠️  WARNING: SA accuracy is very low (0.47%)!
================================================================================
Epoch 2: 100%|##########| 1498/1498 [33:00<00:00,  1.32s/it, L=8.030, SA=0.01, GL=0.00, PW=0.01, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 2 SUMMARY
================================================================================
Learning Rate: 0.000006

Loss Breakdown:
  Total Loss:    8.0303
  SA Loss:       5.3486
  GLCA Loss:     5.3740
  PWCA Loss:     5.3557

Accuracy:
  SA Acc:        0.0062
  GLCA Acc:      0.0043
  PWCA Acc:      0.0053

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0014
  w2 (GLCA):     0.0014
  w3 (PWCA):     0.0014

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9986
  Weight GLCA:   0.9986
  Weight PWCA:   0.9986

⚠️  WARNING: SA accuracy is very low (0.62%)!
================================================================================
Epoch 3: 100%|##########| 1498/1498 [33:00<00:00,  1.32s/it, L=7.907, SA=0.01, GL=0.01, PW=0.01, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 3 SUMMARY
================================================================================
Learning Rate: 0.000009

Loss Breakdown:
  Total Loss:    7.9067
  SA Loss:       5.2547
  GLCA Loss:     5.2757
  PWCA Loss:     5.3304

Accuracy:
  SA Acc:        0.0127
  GLCA Acc:      0.0092
  PWCA Acc:      0.0057

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0037
  w2 (GLCA):     0.0037
  w3 (PWCA):     0.0037

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9963
  Weight GLCA:   0.9963
  Weight PWCA:   0.9963

⚠️  WARNING: SA accuracy is very low (1.27%)!
================================================================================
Epoch 4: 100%|##########| 1498/1498 [33:00<00:00,  1.32s/it, L=7.755, SA=0.02, GL=0.02, PW=0.01, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 4 SUMMARY
================================================================================
Learning Rate: 0.000013

Loss Breakdown:
  Total Loss:    7.7542
  SA Loss:       5.1321
  GLCA Loss:     5.1557
  PWCA Loss:     5.3109

Accuracy:
  SA Acc:        0.0245
  GLCA Acc:      0.0182
  PWCA Acc:      0.0065

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0072
  w2 (GLCA):     0.0072
  w3 (PWCA):     0.0073

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9928
  Weight GLCA:   0.9929
  Weight PWCA:   0.9927

⚠️  WARNING: SA accuracy is very low (2.45%)!
================================================================================
Epoch 5: 100%|##########| 1498/1498 [33:00<00:00,  1.32s/it, L=7.583, SA=0.06, GL=0.05, PW=0.01, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 5 SUMMARY
================================================================================
Learning Rate: 0.000016

Loss Breakdown:
  Total Loss:    7.5829
  SA Loss:       5.0116
  GLCA Loss:     5.0326
  PWCA Loss:     5.2668

Accuracy:
  SA Acc:        0.0554
  GLCA Acc:      0.0467
  PWCA Acc:      0.0090

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0118
  w2 (GLCA):     0.0118
  w3 (PWCA):     0.0121

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9883
  Weight GLCA:   0.9883
  Weight PWCA:   0.9880

⚠️  WARNING: SA accuracy is very low (5.54%)!
================================================================================
Evaluating val: 100%|###########################################| 1449/1449 [03:22<00:00,  7.17it/s]


Epoch 5/100
Train Loss: 7.5829
Val Top-1 Acc: 20.81% (Best: 20.81% @ epoch 5)
Val Top-5 Acc: 46.15%
New best model saved with metric: 20.8146
Epoch 6: 100%|##########| 1498/1498 [33:00<00:00,  1.32s/it, L=7.461, SA=0.08, GL=0.08, PW=0.01, w1=0.0, w2=0.0, w3=0.0]

================================================================================
EPOCH 6 SUMMARY
================================================================================
Learning Rate: 0.000016

Loss Breakdown:
  Total Loss:    7.4602
  SA Loss:       4.9330
  GLCA Loss:     4.9613
  PWCA Loss:     5.2367

Accuracy:
  SA Acc:        0.0758
  GLCA Acc:      0.0808
  PWCA Acc:      0.0127

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0174
  w2 (GLCA):     0.0174
  w3 (PWCA):     0.0178

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9827
  Weight GLCA:   0.9827
  Weight PWCA:   0.9823

⚠️  WARNING: SA accuracy is very low (7.58%)!
================================================================================
Epoch 7: 100%|##########| 1498/1498 [33:00<00:00,  1.32s/it, L=7.395, SA=0.09, GL=0.09, PW=0.02, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 7 SUMMARY
================================================================================
Learning Rate: 0.000016

Loss Breakdown:
  Total Loss:    7.3942
  SA Loss:       4.9120
  GLCA Loss:     4.9447
  PWCA Loss:     5.2101

Accuracy:
  SA Acc:        0.0874
  GLCA Acc:      0.0948
  PWCA Acc:      0.0152

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0232
  w2 (GLCA):     0.0232
  w3 (PWCA):     0.0238

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9771
  Weight GLCA:   0.9771
  Weight PWCA:   0.9765

⚠️  WARNING: SA accuracy is very low (8.74%)!
================================================================================
Epoch 8: 100%|##########| 1498/1498 [33:01<00:00,  1.32s/it, L=7.380, SA=0.07, GL=0.08, PW=0.02, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 8 SUMMARY
================================================================================
Learning Rate: 0.000016

Loss Breakdown:
  Total Loss:    7.3805
  SA Loss:       4.9425
  GLCA Loss:     4.9702
  PWCA Loss:     5.1962

Accuracy:
  SA Acc:        0.0681
  GLCA Acc:      0.0751
  PWCA Acc:      0.0189

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0290
  w2 (GLCA):     0.0290
  w3 (PWCA):     0.0297

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9714
  Weight GLCA:   0.9714
  Weight PWCA:   0.9708

⚠️  WARNING: SA accuracy is very low (6.81%)!
================================================================================
Epoch 9: 100%|##########| 1498/1498 [33:01<00:00,  1.32s/it, L=7.397, SA=0.05, GL=0.06, PW=0.02, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 9 SUMMARY
================================================================================
Learning Rate: 0.000016

Loss Breakdown:
  Total Loss:    7.3975
  SA Loss:       4.9948
  GLCA Loss:     5.0194
  PWCA Loss:     5.2002

Accuracy:
  SA Acc:        0.0522
  GLCA Acc:      0.0552
  PWCA Acc:      0.0182

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0349
  w2 (GLCA):     0.0349
  w3 (PWCA):     0.0355

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9657
  Weight GLCA:   0.9657
  Weight PWCA:   0.9651

⚠️  WARNING: SA accuracy is very low (5.22%)!
================================================================================
Epoch 10: 100%|#########| 1498/1498 [33:00<00:00,  1.32s/it, L=7.412, SA=0.03, GL=0.04, PW=0.01, w1=0.0, w2=0.0, w3=0.0]


================================================================================
EPOCH 10 SUMMARY
================================================================================
Learning Rate: 0.000016

Loss Breakdown:
  Total Loss:    7.4125
  SA Loss:       5.0418
  GLCA Loss:     5.0645
  PWCA Loss:     5.2101

Accuracy:
  SA Acc:        0.0334
  GLCA Acc:      0.0367
  PWCA Acc:      0.0145

Uncertainty Weights (raw w_i):
  w1 (SA):       0.0407
  w2 (GLCA):     0.0407
  w3 (PWCA):     0.0413

Effective Loss Weights (1/exp(w_i)):
  Weight SA:     0.9601
  Weight GLCA:   0.9601
  Weight PWCA:   0.9596

⚠️  WARNING: SA accuracy is very low (3.34%)!
================================================================================
Evaluating val: 100%|###########################################| 1449/1449 [03:21<00:00,  7.17it/s]


Epoch 10/100
Train Loss: 7.4125
Val Top-1 Acc: 4.64% (Best: 20.81% @ epoch 5)
Val Top-5 Acc: 17.76%
Epoch 11:  55%|#####5    | 826/1498 [18:11<14:30,  1.30s/it, L=7.405, SA=0.03, GL=0.03, PW=0.01, w1=0.0, w2=0.0, w3=0.0]
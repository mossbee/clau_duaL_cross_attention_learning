Setting up training components...
Loading pretrained weights from /kaggle/input/cub-200-2011/ViT-B_16.npz
Model initialized with 100.73M parameters
CUB Dataset: 5994 train samples loaded
CUB Dataset: 5794 test samples loaded
Starting training for 100 epochs
Training samples: 5994
Validation samples: 5794
Physical batch size: 8
Gradient accumulation steps: 2
Effective batch size: 16
Epoch 1: 100%|█| 749/749 [17:04<00:00,  1.37s/it, loss=7.8393, sa_acc=0.020, glc
Current LR: 0.000016
Epoch 2: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=7.1823, sa_acc=0.123, glc
Current LR: 0.000016
Epoch 3: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=6.3769, sa_acc=0.307, glc
Current LR: 0.000016
Epoch 4: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.6865, sa_acc=0.415, glc
Current LR: 0.000016
Epoch 5: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.1169, sa_acc=0.469, glc
Current LR: 0.000016
Evaluating val: 100%|█████████████████████████| 725/725 [04:25<00:00,  2.73it/s]
Epoch 5/100
Train Loss: 5.1038
Val Metric: 59.3200 (Best: 59.3200 @ epoch 5)
New best model saved with metric: 59.3200
Epoch 6: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.6928, sa_acc=0.494, glc
Current LR: 0.000016
Epoch 7: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.4316, sa_acc=0.491, glc
Current LR: 0.000015
Epoch 8: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.3289, sa_acc=0.455, glc
Current LR: 0.000015
Epoch 9: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.2798, sa_acc=0.443, glc
Current LR: 0.000015
Epoch 10: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.3378, sa_acc=0.412, gl
Current LR: 0.000015
Evaluating val: 100%|█████████████████████████| 725/725 [04:25<00:00,  2.74it/s]
Epoch 10/100
Train Loss: 4.3376
Val Metric: 41.7501 (Best: 59.3200 @ epoch 5)
Epoch 11: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.4183, sa_acc=0.375, gl
Current LR: 0.000015
Epoch 12: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.5719, sa_acc=0.325, gl
Current LR: 0.000015
Epoch 13: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.6569, sa_acc=0.306, gl
Current LR: 0.000015
Epoch 14: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.7761, sa_acc=0.277, gl
Current LR: 0.000015
Epoch 15: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=4.9155, sa_acc=0.251, gl
Current LR: 0.000015
Evaluating val: 100%|█████████████████████████| 725/725 [04:24<00:00,  2.74it/s]
Epoch 15/100
Train Loss: 4.9265
Val Metric: 25.7508 (Best: 59.3200 @ epoch 5)
Epoch 16: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.0061, sa_acc=0.227, gl
Current LR: 0.000015
Epoch 17: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.1270, sa_acc=0.206, gl
Current LR: 0.000015
Epoch 18: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.1762, sa_acc=0.193, gl
Current LR: 0.000015
Epoch 19: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.2619, sa_acc=0.179, gl
Current LR: 0.000014
Epoch 20: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.3299, sa_acc=0.170, gl
Current LR: 0.000014
Evaluating val: 100%|█████████████████████████| 725/725 [04:24<00:00,  2.74it/s]
Epoch 20/100
Train Loss: 5.3357
Val Metric: 16.0856 (Best: 59.3200 @ epoch 5)
Epoch 21: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.4112, sa_acc=0.156, gl
Current LR: 0.000014
Epoch 22: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.4132, sa_acc=0.146, gl
Current LR: 0.000014
Epoch 23: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.4646, sa_acc=0.135, gl
Current LR: 0.000014
Epoch 24: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5065, sa_acc=0.129, gl
Current LR: 0.000014
Epoch 25: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.5262, sa_acc=0.125, gl
Current LR: 0.000014
Evaluating val: 100%|█████████████████████████| 725/725 [04:24<00:00,  2.74it/s]
Epoch 25/100
Train Loss: 5.5280
Val Metric: 12.2195 (Best: 59.3200 @ epoch 5)
Epoch 26: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5457, sa_acc=0.122, gl
Current LR: 0.000013
Epoch 27: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.5646, sa_acc=0.119, gl
Current LR: 0.000013
Epoch 28: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5769, sa_acc=0.120, gl
Current LR: 0.000013
Epoch 29: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5715, sa_acc=0.116, gl
Current LR: 0.000013
Epoch 30: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5571, sa_acc=0.114, gl
Current LR: 0.000013
Evaluating val: 100%|█████████████████████████| 725/725 [04:24<00:00,  2.74it/s]
Epoch 30/100
Train Loss: 5.5556
Val Metric: 10.8906 (Best: 59.3200 @ epoch 5)
Epoch 31: 100%|█| 749/749 [17:03<00:00,  1.37s/it, loss=5.5595, sa_acc=0.117, gl
Current LR: 0.000013
Epoch 32: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5487, sa_acc=0.111, gl
Current LR: 0.000012
Epoch 33: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5773, sa_acc=0.101, gl
Current LR: 0.000012
Epoch 34: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5514, sa_acc=0.105, gl
Current LR: 0.000012
Epoch 35: 100%|█| 749/749 [17:02<00:00,  1.37s/it, loss=5.5359, sa_acc=0.107, gl
Current LR: 0.000012
Evaluating val: 100%|█████████████████████████| 725/725 [04:24<00:00,  2.74it/s]
Epoch 35/100
Train Loss: 5.5367
Val Metric: 9.6134 (Best: 59.3200 @ epoch 5)
Epoch 36:   1%| | 11/749 [00:14<15:39,  1.27s/it, loss=4.8740, sa_acc=0.250, glc